📄 ThesisFormatter (论文格式智能转换引擎)
ThesisFormatter 是一个基于 Python tkinter 和 python-docx 开发的轻量级桌面端工具。它能够无侵入地接管繁杂的 Word 文档排版工作，通过启发式规则自动推断文档的标题层级，并一键应用标准化的学术排版规范。

摆脱手动调整“字体、字号、行距、缩进”的折磨，让研究人员将精力回归到内容本身。

✨ 核心特性
🧠 启发式标题推断：告别依赖 Word 内置样式的痛点。基于正则表达式与上下文特征（字号对比、加粗状态、字符长度），自动判定主标题、多级标题（一/二/三级）与正文。

🔤 中西文字体分离渲染：利用 w:rFonts 底层标签，精确实现 Word 级别的“中文字体（如宋体）+ 西文字体（如 Times New Roman）”混合排版，无需手动拆分文本节点。

🔬 格式审查系统：在执行覆写前，自动扫描文档并生成“差异报告”，指出字号错误或首行缩进遗漏的具体段落。

🛠️ 多配置模板管理：内置“通用模板”与“学术期刊投稿”两套标准，支持通过 GUI 深度定制并持久化至 config.json。

🖥️ 零配置开箱即用：提供直观的 Tkinter 图形界面和实时运行日志，无需任何命令行操作经验。

⚙️ 核心工作原理
本工具的层级识别算法（detect_level）按以下优先级短路求值：

超长段落拦截：长度超过 40 字符的段落直接归类为 body。

多级编号正则匹配：

三级标题：匹配 X.X.X 格式。

二级标题：匹配 X.X 格式。

一级标题：匹配 第X章、一、、1. 等格式。

视觉特征降维打击：对于短段落，如果其文本加粗，或字号（w:sz）大于上下文相邻段落，则判定为 main_title。

默认回退：其余所有段落归类为 body。

📦 快速启动
1. 克隆仓库与安装依赖

Bash
[git clone https://github.com/yourusername/ThesisFormatter.git](https://github.com/Guopeizeng/ThesisFormatter.git)
cd ThesisFormatter
pip install python-docx
2. 启动图形界面

Bash
python format_thesis.py
🎯 使用指南
运行程序后，选择需要排版的源文件（.docx）。

在格式模板区下拉选择，或点击新建/编辑模板调整具体参数（字号请使用“半磅”单位，如小四号 12pt = 24）。

推荐先点击 📋 格式检查，在日志区预览文档结构是否被正确识别。

点击 ✅ 开始转换，程序将生成带有 _已格式化.docx 后缀的安全副本。

📅 路线图 (TODO)
[x] 支持基础段落的字体与间距调整。

[x] 图形化界面的日志输出。

[ ] 支持图表题注（Figure/Table）的自动识别与居中。

[ ] 参考文献（References）悬挂缩进的自动应用。

[ ] 打包为 Windows 可执行文件（.exe），免 Python 环境运行。

🤝 贡献说明
欢迎提交 Issue 报告 Bug，或者发起 Pull Request 改进标题识别的正则表达式。
